---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/tidyverse/googlesheets4.svg?branch=master)](https://travis-ci.org/tidyverse/googlesheets4)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/tidyverse/googlesheets4?branch=master&svg=true)](https://ci.appveyor.com/project/tidyverse/googlesheets4)
[![Coverage status](https://codecov.io/gh/tidyverse/googlesheets4/branch/master/graph/badge.svg)](https://codecov.io/github/tidyverse/googlesheets4?branch=master)

# googlesheets4

googlesheets4 provides an R interface to [Google Sheets](https://spreadsheets.google.com/) via the [Sheets API v4](https://developers.google.com/sheets/api/). It is a reboot of the existing [googlesheets package](https://cran.r-project.org/package=googlesheets).

*Why **4**? Why googlesheets**4**? Did I miss googlesheets1 through 3? No. The idea is to name the package after the corresponding version of the Sheets API. In hindsight, the original googlesheets should have should have been googlesheets**3**.*

## Installation

You can install the released version of googlesheets4 from [CRAN](https://CRAN.R-project.org) with:

``` r
## NO, NO YOU CANNOT
## install.packages("googlesheets4")
```

And the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tidyverse/googlesheets4")
```

## Read a public Sheet

```{r}
library(googlesheets4)

## read worksheets out of a spreadsheet with excerpts from the Gapminder data
read_sheet(sheets_example("mini-gap"))
read_sheet(sheets_example("mini-gap"), sheet = 2)
read_sheet(sheets_example("mini-gap"), sheet = "Oceania", n_max = 3)

## read from a Sheets version of an example from readxl
## shows range support and column type specification, mixing types and "guess"
read_sheet(
  sheets_example("deaths"), range = "other!A5:F15", col_types = "?ci??D"
)
```

`read_sheet()` is the main "read" function and should evoke `readr::read_csv()` and `readxl::read_excel()` for you. It's an alias for `sheets_read()`, since most functions in googlesheets actually start with the `sheets_` prefix. googlesheets4 is pipe-friendly (and rexports `%>%`), but works just fine without the pipe.

googlesheets4 draws on and complements / emulates other packages in the tidyverse:

  * [googledrive](http://googledrive.tidyverse.org) already provides a fully-featured interface to the Google Drive API. Any "whole file" operations can already be accomplished *today* with googledrive: upload or download or update a spreadsheet, copy, rename, move, change permission, delete, etc. googledrive already supports OAuth2 and Team Drives.
  * [readxl](https://github.com/tidyverse/readxl) is the tidyverse package for reading Excel files (xls or xlsx) into an R data frame. googlesheets4 takes cues from parts of the readxl interface, especially around specifying which cells to read.
  * [readr](http://readr.tidyverse.org) is the tidyverse package fro reading delimited files (e.g., csv or tsv) into an R data frame. googlesheets4 takes cues from readr with respect to column type specification.

## Other functions

googlesheets4 exposes Sheet metadata via `sheets_get()` and can also be used to access raw cell data (one row per cell) via `sheets_cell()`. That data can be post-processed with `spread_sheet()` to obtain the same data frame you get from `read_sheet()`.

```{r}
sheets_get(sheets_example("mini-gap"))

sheets_get(sheets_example("deaths"))

(df <- sheets_cells(sheets_example("deaths"), range = "E5:E7"))
df$cell[[3]]

spread_sheet(df, col_types = "D")
read_sheet(sheets_example("deaths"), range = "E5:E7", col_types ="D")
```

## What's coming soon?

OAuth2

Writing to Sheets

*Please note that this project is released with a [Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md).
By participating in this project you agree to abide by its terms.*
