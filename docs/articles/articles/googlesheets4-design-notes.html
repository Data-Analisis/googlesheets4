<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>googlesheets4 design notes • googlesheets4</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../index.html">googlesheets4</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/googlesheets4-design-notes.html">googlesheets4 design notes</a>
    </li>
    <li>
      <a href="../../articles/articles/sheets-api-v4.html">Google Sheets API v4</a>
    </li>
    <li>
      <a href="../../articles/articles/sheets-auth-flow.html">Google Sheets API v4 Auth Flow</a>
    </li>
    <li>
      <a href="../../articles/whatever.html">Imagine a vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tidyverse/googlesheets4">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>googlesheets4 design notes</h1>
            
          </div>

    
    
<div class="contents">
<p><em>This is useful to me and not necessarily for outside consumption.</em></p>
<div id="peer-group" class="section level2">
<h2 class="hasAnchor">
<a href="#peer-group" class="anchor"></a>Peer group</h2>
<p>Packages to consider in design of googlesheets4:</p>
<ul>
<li>googlesheets: let’s keep the good and fix the bad</li>
<li>readr: reference point for UI, col spec, parsing</li>
<li>readxl: reference point for parsing, (work)sheets/tabs, cell ranges</li>
</ul>
</div>
<div id="col-spec" class="section level2">
<h2 class="hasAnchor">
<a href="#col-spec" class="anchor"></a>Col spec</h2>
<p>All 3 packages provide a way for user to specify the output type of each column.</p>
<p>readr has the col spec system that we are most commited to long-term. <code>col_types</code> accepts a string using a single letter shorthand (e.g. <code>"c"</code> for character), as well as a longer form more conducive to passing ancillary info, such as datetime format. If no column type is given, it is guessed.</p>
<p>googlesheets exposes the readr col spec API. All <code>gs_read*()</code> functions literally call either <code>read_csv()</code> or <code>type_convert()</code>. This has downsides, primarily the fact that, by default, googlesheets reads and parses <em>formatted</em> cell contents. The good news is that googlesheets did not introduce its own way to describe col spec.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(googlesheets)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/googlesheets/topics/gs_read">gs_read</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/googlesheets/topics/example-sheets">gs_gap</a></span>(), <span class="dt">ws =</span> <span class="st">"Europe"</span>, <span class="dt">n_max =</span> <span class="dv">4</span>, <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"cciddd"</span>))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Accessing worksheet titled 'Europe'.</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; # A tibble: 4 x 6</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;   country continent  year lifeExp      pop gdpPercap</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; 1 Albania Europe     1952    55.2 1282697.     1601.</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; 2 Albania Europe     1957    59.3 1476505.     1942.</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; 3 Albania Europe     1962    64.8 1728137.     2313.</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 4 Albania Europe     1967    66.2 1984060.     2760.</span></a></code></pre></div>
<p>readxl has its own col spec system, but it is slated to evolve towards readr. <code>col_types</code> is a character vector with one entry per column from these options: “skip”, “guess”, “logical”, “numeric”, “date”, “text” or “list”. It lacks some of readr’s output types and control: no integers (Excel itself has no concept of integer, but still), no factors, less variety wrt date/time/datetime. The “list” type is unique to readxl and is equally relevant to Google Sheets.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">(clippy &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/readxl/topics/read_excel">read_excel</a></span>(</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="kw"><a href="http://www.rdocumentation.org/packages/readxl/topics/readxl_example">readxl_example</a></span>(<span class="st">"clippy.xlsx"</span>),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">"text"</span>, <span class="st">"list"</span>))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; # A tibble: 4 x 2</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;   name                 value     </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;   &lt;chr&gt;                &lt;list&gt;    </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 1 Name                 &lt;chr [1]&gt; </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 2 Species              &lt;chr [1]&gt; </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 3 Approx date of death &lt;dttm [1]&gt;</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 4 Weight in grams      &lt;dbl [1]&gt;</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/enframe">deframe</a></span>(clippy)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; $Name</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; [1] "Clippy"</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; $Species</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; [1] "paperclip"</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; $`Approx date of death`</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; [1] "2007-01-01 UTC"</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; $`Weight in grams`</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; [1] 0.9</span></a></code></pre></div>
</div>
<div id="parsing" class="section level2">
<h2 class="hasAnchor">
<a href="#parsing" class="anchor"></a>Parsing</h2>
<p>Given a column type, each cell is processed to produce an atom in a vector of the target type. This is a loop over cells (within a loop over columns).</p>
<p>readxl: We infer type for every cell, either in the guessing pass or at parse time. Cell type inference is based on Excel’s declared cell type, the cell data, and user inputs <code>na</code> and <code>trim_ws</code> (e.g., <a href="https://github.com/tidyverse/readxl/blob/c02f81c3b9f7c6177ed9d13748377450bff9abe1/src/XlsxCell.h#L56" class="uri">https://github.com/tidyverse/readxl/blob/c02f81c3b9f7c6177ed9d13748377450bff9abe1/src/XlsxCell.h#L56</a>):</p>
<p>The cell type and the column type are both enums:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">enum</span> CellType {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  CELL_UNKNOWN,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  CELL_BLANK,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  CELL_LOGICAL,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  CELL_DATE,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  CELL_NUMERIC,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  CELL_TEXT</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">};</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw">enum</span> ColType {</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  COL_UNKNOWN, <span class="co">// implies column type needs to be guessed</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  COL_BLANK,   <span class="co">// occurs when col_types = NULL and observe only CELL_BLANKs</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  COL_LOGICAL,</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  COL_DATE,</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  COL_NUMERIC,</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  COL_TEXT,</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  COL_LIST,    <span class="co">// occurs only as user-specified column type</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  COL_SKIP     <span class="co">// occurs only as user-specified column type</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">};</a></code></pre></div>
<p>There is a large <code>switch()</code> statement that fits a cell of type <em>x</em> into a column of type <em>y</em>. This is simple for matching types, such as <code>CELL_TEXT</code> and <code>COL_TEXT</code>. When it’s not, we must coerce. The simplest coercions are when <code>NA</code> is the only sensible value, such as <code>CELL_LOGICAL</code> to <code>COL_DATE</code>. Examples of trickier coercions: <code>CELL_TEXT</code> to <code>COL_LOGICAL</code> (we use R’s rules for this) or <code>CELL_DATE</code> to <code>COL_TEXT</code> (we can’t really do this right now).</p>
<p>readr. I don’t know it well enough to give same summary. Will do if becomes necessary. The googlesheets4 parsing is more likely to be modelled after readxl anyway, because the info available for each cell is more similar. Presumably there is no notion of “cell type” for readr, since it is always a string.</p>
<p>List of the readr parsers (single character shorthand in parens):</p>
<ul>
<li>
<code>guess_parser()</code> (?)</li>
<li>
<code>col_skip()</code> (_) (-)</li>
<li>
<code>parse_logical()</code> (l)</li>
<li>
<code>parse_integer()</code> (i)</li>
<li>
<code>parse_double()</code> (d)</li>
<li>
<code>parse_number()</code> (n)</li>
<li>
<code>parse_datetime(..., format = "??")</code> (T)</li>
<li>
<code>parse_date(..., format = "??")</code> (D)</li>
<li>
<code>parse_time(..., format = "??")</code> (t)</li>
<li>
<code>parse_factor(..., levels = "??")</code> <em>why does this not have shortcode? issue opened</em>
</li>
<li>
<code>parse_character()</code> (c)</li>
</ul>
</div>
<div id="guessing" class="section level2">
<h2 class="hasAnchor">
<a href="#guessing" class="anchor"></a>Guessing</h2>
<p>readxl guesses a col type like so:</p>
<ul>
<li>Determine cell type = cell enum value.</li>
<li>Track cumulative max enum value for the first <code>guess_max</code> cells. Bit of hand-waving here because, while it’s clear that Boolean &lt; integer &lt; double, datetimes are just special.</li>
<li>The max enum value is the guessed col type.</li>
</ul>
<p>readr: I haven’t looked at this. I assume it is also a “max col type” approach.</p>
<p>Observation: It makes sense and is very R-like to take the “maximum” type, i.e. the current pushes everything towards character. Is it worth considering a “majority rules” mentality?</p>
</div>
<div id="google-sheet-cell-data-from-sheets-api-v4" class="section level2">
<h2 class="hasAnchor">
<a href="#google-sheet-cell-data-from-sheets-api-v4" class="anchor"></a>Google Sheet cell data from Sheets API v4</h2>
<p>Two options:</p>
<ul>
<li>
<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values">spreadsheets.values collection</a>: simplest for reading/writing spreadsheet values. Would be nice to use this, but …</li>
<li>
<a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets">spreadsheets collection</a>: for reading/writing any aspect of the spreadsheet. It appears that I <em>must</em> use this. Cell typing and coercion will be better if we have the contents in various forms (e.g., unformatted and formatted), plus information about the format itself.</li>
</ul>
<p>In everything below, I’m suppressing the fact that it’s possible to limit the read to specific cells. Not relevant for picking the endpoint.</p>
<div id="examples" class="section level3">
<h3 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h3>
<p>Let’s look at numeric data, especially datetimes and datetime formulas, to see exactly what’s available for a cell.</p>
<p>Reading from this Sheet:</p>
<p><a href="https://docs.google.com/spreadsheets/d/1xTUxWGcFLtDIHoYJ1WsjQuLmpUtBf--8Bcu5lQ302SU/edit#gid=0" class="uri">https://docs.google.com/spreadsheets/d/1xTUxWGcFLtDIHoYJ1WsjQuLmpUtBf--8Bcu5lQ302SU/edit#gid=0</a></p>
<div id="spreadsheets-values-get" class="section level4">
<h4 class="hasAnchor">
<a href="#spreadsheets-values-get" class="anchor"></a>spreadsheets.values.get</h4>
<p><em>This can be skipped, because I suspect we will not use this endpoint. But I needed to take a look.</em></p>
<p><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get"><code>spreadsheets.values.get</code></a> has three query parameters:</p>
<ul>
<li>
<code>majorDimension</code>: whether row or column increments fastest in the reply. Boring. Not explored.</li>
<li>
<code>valueRenderOption</code>: An enum:
<ul>
<li>
<code>FORMATTED_VALUE</code> (default): Values calculated &amp; formatted according to the cell’s formatting (automatic or explicit) and spreadsheet’s locale. You basically get the strings that user sees in the browser. Current googlesheets package works with v3 equivalent of this and processes via readr.</li>
<li>
<code>UNFORMATTED_VALUE</code>: Values are calculated but not formatted. Except there’s a loophole: iff the cell has a date-ish format and <code>dateTimeRenderOption = "FORMATTED_STRING"</code>, then the those specific cells are handled as if <code>valueRenderOption = "FORMATTED_VALUE"</code>. I don’t see any clever way to exploit this, but just note it.</li>
<li>
<code>FORMULA</code>: Values are not calculated. You get what was entered. If the cell contains a formula, you get that. For non-formula cells, seems to be equivalent to<code>UNFORMATTED_VALUE</code>. Except for the same loophole noted above for cells bearing a date-ish format when <code>dateTimeRenderOption = "FORMATTED_STRING"</code>.</li>
</ul>
</li>
<li>
<code>dateTimeRenderOption</code>: An enum:
<ul>
<li>Ignored if <code>valueRenderOption = "FORMATTED_VALUE"</code>, which is the default.</li>
<li>
<code>SERIAL_NUMBER</code> (default): Cells formatted as date, time, datetime, or duration are output as doubles in “serial number” format. The whole number portion of the value (left of the decimal) counts the days since December 30th 1899. The fractional portion (right of the decimal) counts the time as a fraction of the day. 1900 is not treated as a leap year, i.e. Sheets does not reproduce the Lotus 1-2-3 bug.</li>
<li>
<code>FORMATTED_STRING</code>: Date-ish cells are returned as formatted strings, even if <code>valueRenderOption = "UNFORMATTED_VALUE"</code>.</li>
</ul>
</li>
</ul>
<p><em>hidden chunk here that hits the <code>spreadsheets.values.get</code> endpoint and gets response ready for inspection</em></p>
<p>Side-by-side comparison of <code>FORMATTED_VALUE</code> vs. <code>UNFORMATTED_VALUE</code> vs. <code>FORMULA</code>. Remember this requires 3 separate API calls, i.e. you can’t get all 3 of these from <code>spreadsheet.values</code> at the same time.</p>
<pre><code>#&gt; # A tibble: 30 x 5
#&gt;    as_entered         format    FORMATTED_VALUE   UNFORMATTED_VAL… FORMULA
#&gt;    &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;            &lt;chr&gt;  
#&gt;  1 3/10/2018 11:11:11 Date time 3/10/2018 11:11:… 43169.466099537  43169.…
#&gt;  2 =TODAY()           automatic 3/11/2018         43170            =TODAY…
#&gt;  3 =TODAY()           Date      3/11/2018         43170            =TODAY…
#&gt;  4 =TODAY()           Time      12:00:00 AM       43170            =TODAY…
#&gt;  5 =TODAY()           Date time 3/11/2018 0:00:00 43170            =TODAY…
#&gt;  6 =TODAY()           Plain te… 43170             43170            =TODAY…
#&gt;  7 =TODAY()           Number    43,170.00         43170            =TODAY…
#&gt;  8 =TODAY()           "From \"… Sunday, March 11… 43170            =TODAY…
#&gt;  9 =now()             automatic 3/11/2018 21:59:… 43170.916617581  =now() 
#&gt; 10 =now()             Date      3/11/2018         43170.916617581  =now() 
#&gt; 11 =now()             Time      9:59:56 PM        43170.916617581  =now() 
#&gt; 12 =now()             Date time 3/11/2018 21:59:… 43170.916617581  =now() 
#&gt; 13 =now()             Plain te… 43170.91662       43170.916617581  =now() 
#&gt; 14 =now()             Number    43,170.92         43170.916617581  =now() 
#&gt; 15 =now()             "From \"… Sunday, March 11… 43170.916617581  =now() 
#&gt; 16 =EDATE(A9, -4)     automatic 11/11/2017        43050            =EDATE…
#&gt; 17 =EDATE(A9, -4)     Date      11/11/2017        43050            =EDATE…
#&gt; 18 =EDATE(A9, -4)     Time      12:00:00 AM       43050            =EDATE…
#&gt; 19 =EDATE(A9, -4)     Date time 11/11/2017 0:00:… 43050            =EDATE…
#&gt; 20 =EDATE(A9, -4)     Plain te… 43050             43050            =EDATE…
#&gt; 21 =EDATE(A9, -4)     Number    43,050.00         43050            =EDATE…
#&gt; 22 =EDATE(A9, -4)     "From \"… Saturday, Novemb… 43050            =EDATE…
#&gt; 23 0.015              automatic 0.015             0.015            0.015  
#&gt; 24 0.015              Percent   1.50%             0.015            0.015  
#&gt; 25 1.5%               automatic 1.50%             0.015            0.015  
#&gt; 26 1234567890         automatic 1234567890        1234567890       123456…
#&gt; 27 1234567890         Scientif… 1.23E+09          1234567890       123456…
#&gt; 28 $1.23              automatic $1.23             1.23             1.23   
#&gt; 29 $1.23              Currency… $1                1.23             1.23   
#&gt; 30 1.23               Currency  $1.23             1.23             1.23</code></pre>
<p>Here’s a look at same, but combined with <code>dateTimeRenderOption = "FORMATTED_STRING"</code>. Observations:</p>
<ul>
<li>
<code>FORMATTED_VALUE</code> is same as above.</li>
<li>
<code>UNFORMATTED_VALUE</code> is same as <code>FORMATTED_VALUE</code> for cells bearing a date-ish format.</li>
<li>
<code>FORMULA</code> is same as above for formula cells and numbers entered as numbers. I note <code>FORMULA</code> is different in the case of the datetime that was typed in (first row).</li>
</ul>
<pre><code>#&gt; # A tibble: 30 x 5
#&gt;    as_entered         format  FORMATTED_VALUE2  UNFORMATTED_VALU… FORMULA2
#&gt;    &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;   
#&gt;  1 3/10/2018 11:11:11 Date t… 3/10/2018 11:11:… 3/10/2018 11:11:… 3/10/20…
#&gt;  2 =TODAY()           automa… 3/11/2018         3/11/2018         =TODAY()
#&gt;  3 =TODAY()           Date    3/11/2018         3/11/2018         =TODAY()
#&gt;  4 =TODAY()           Time    12:00:00 AM       12:00:00 AM       =TODAY()
#&gt;  5 =TODAY()           Date t… 3/11/2018 0:00:00 3/11/2018 0:00:00 =TODAY()
#&gt;  6 =TODAY()           Plain … 43170             43170             =TODAY()
#&gt;  7 =TODAY()           Number  43,170.00         43170             =TODAY()
#&gt;  8 =TODAY()           "From … Sunday, March 11… Sunday, March 11… =TODAY()
#&gt;  9 =now()             automa… 3/11/2018 21:59:… 3/11/2018 21:59:… =now()  
#&gt; 10 =now()             Date    3/11/2018         3/11/2018         =now()  
#&gt; 11 =now()             Time    9:59:56 PM        9:59:56 PM        =now()  
#&gt; 12 =now()             Date t… 3/11/2018 21:59:… 3/11/2018 21:59:… =now()  
#&gt; 13 =now()             Plain … 43170.91662       43170.916617581   =now()  
#&gt; 14 =now()             Number  43,170.92         43170.916617581   =now()  
#&gt; 15 =now()             "From … Sunday, March 11… Sunday, March 11… =now()  
#&gt; 16 =EDATE(A9, -4)     automa… 11/11/2017        11/11/2017        =EDATE(…
#&gt; 17 =EDATE(A9, -4)     Date    11/11/2017        11/11/2017        =EDATE(…
#&gt; 18 =EDATE(A9, -4)     Time    12:00:00 AM       12:00:00 AM       =EDATE(…
#&gt; 19 =EDATE(A9, -4)     Date t… 11/11/2017 0:00:… 11/11/2017 0:00:… =EDATE(…
#&gt; 20 =EDATE(A9, -4)     Plain … 43050             43050             =EDATE(…
#&gt; 21 =EDATE(A9, -4)     Number  43,050.00         43050             =EDATE(…
#&gt; 22 =EDATE(A9, -4)     "From … Saturday, Novemb… Saturday, Novemb… =EDATE(…
#&gt; 23 0.015              automa… 0.015             0.015             0.015   
#&gt; 24 0.015              Percent 1.50%             0.015             0.015   
#&gt; 25 1.5%               automa… 1.50%             0.015             0.015   
#&gt; 26 1234567890         automa… 1234567890        1234567890        1234567…
#&gt; 27 1234567890         Scient… 1.23E+09          1234567890        1234567…
#&gt; 28 $1.23              automa… $1.23             1.23              1.23    
#&gt; 29 $1.23              Curren… $1                1.23              1.23    
#&gt; 30 1.23               Curren… $1.23             1.23              1.23</code></pre>
</div>
<div id="spreadsheets-get" class="section level4">
<h4 class="hasAnchor">
<a href="#spreadsheets-get" class="anchor"></a>spreadsheets.get</h4>
<p><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/get"><code>spreadsheets.get</code></a> can return cell data:</p>
<ul>
<li>
<code>includeGridData = "TRUE"</code>: Put this in the query to request cell data. You will get <em>everything</em>.</li>
<li>Field mask. More granular way to specify desired fields in the query. We’ll use this in the long-run, for fine control. I’ve used <code>includeGridData</code> in this pilot study too see full detail (some of which I am still suppressing).</li>
</ul>
<p><em>hidden chunk here that hits the <code>spreadsheets.get</code> endpoint and gets response ready for inspection</em></p>
<p>If you drill down, the data you get for each cell is an instance of <a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets#CellData"><code>CellData</code></a>.</p>
<p>Here’s (trimmed down) <code>CellData</code> on cell A2, a literal, explicitly formatted datetime:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">str</span>(resp[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; List of 5</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  $ userEnteredValue :List of 1</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;   ..$ numberValue: num 43169</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;  $ effectiveValue   :List of 1</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;   ..$ numberValue: num 43169</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  $ formattedValue   : chr "3/10/2018 11:11:11"</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  $ userEnteredFormat:List of 1</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;   ..$ numberFormat:List of 2</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   .. ..$ type   : chr "DATE_TIME"</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;   .. ..$ pattern: chr "M/d/yyyy H:mm:ss"</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  $ effectiveFormat  :List of 1</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;   ..$ numberFormat:List of 2</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;   .. ..$ type   : chr "DATE_TIME"</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;   .. ..$ pattern: chr "M/d/yyyy H:mm:ss"</span></a></code></pre></div>
<p>Here’s (trimmed down) <code>CellData</code> on cell A3, an automatically formatted datetime formula:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">str</span>(resp[[<span class="dv">3</span>]])</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;  $ userEnteredValue:List of 1</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;   ..$ formulaValue: chr "=TODAY()"</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;  $ effectiveValue  :List of 1</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;   ..$ numberValue: int 43170</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  $ formattedValue  : chr "3/11/2018"</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  $ effectiveFormat :List of 1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;   ..$ numberFormat:List of 1</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;   .. ..$ type: chr "DATE"</span></a></code></pre></div>
<p>Observations:</p>
<ul>
<li>
<code>effectiveValue</code> and <code>effectiveFormat</code> provide the basis for cell typing.</li>
<li>
<code>formattedValue</code> is useful for coercing to character, i.e. Google has already done it and, unlike Excel, exposes it.</li>
<li>
<code>effectiveFormat</code> <em>could</em> provide a basis for transmitting datetime format from the Sheet into R, if we had a lexicon or a grammar for the formats. <a href="https://developers.google.com/sheets/api/guides/formats">Sheets API docs on Date and Number Formats</a>. <a href="https://github.com/WizardMac/TimeFormatStrings">TimeFormatStrings</a>, a C library to read and write time format strings (Excel, Stata, Unicode).</li>
<li>
<code>userEnteredValue</code> could be used if we aspire to return formulas.</li>
</ul>
<p>Let’s look at these fields for all cells.</p>
<p><code>userEnteredValue</code> and <code>effectiveValue</code> hold an instance of <code>ExtendedValue</code>, which is always exactly one of the following:</p>
<ul>
<li><code>numberValue</code></li>
<li><code>stringValue</code></li>
<li><code>boolValue</code></li>
<li><code>formulaValue</code></li>
<li>
<code>errorValue</code>, which will be an instance of <code>ErrorValue</code>
</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(formattedValue, <span class="kw">starts_with</span>(<span class="st">"user"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; # A tibble: 31 x 3</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;    formattedValue                  userEnteredValue_n… userEnteredValue_v…</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;                           &lt;chr&gt;               &lt;chr&gt;              </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1 x                               stringValue         x                  </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;  2 3/10/2018 11:11:11              numberValue         43169.466100       </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  3 3/11/2018                       formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  4 3/11/2018                       formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  5 12:00:00 AM                     formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;  6 3/11/2018 0:00:00               formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  7 43170                           formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  8 43,170.00                       formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  9 Sunday, March 11, 2018 at 12:0… formulaValue        =TODAY()           </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; 10 3/11/2018 21:59:56              formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; 11 3/11/2018                       formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; 12 9:59:56 PM                      formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; 13 3/11/2018 21:59:56              formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; 14 43170.91662                     formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; 15 43,170.92                       formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; 16 Sunday, March 11, 2018 at 9:59… formulaValue        =now()             </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; 17 11/11/2017                      formulaValue        =EDATE(A10, -4)    </span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; 18 11/11/2017                      formulaValue        =EDATE(A11, -4)    </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; 19 12:00:00 AM                     formulaValue        =EDATE(A12, -4)    </span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; 20 11/11/2017 0:00:00              formulaValue        =EDATE(A13, -4)    </span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; 21 43050                           formulaValue        =EDATE(A14, -4)    </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; 22 43,050.00                       formulaValue        =EDATE(A15, -4)    </span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; 23 Saturday, November 11, 2017 at… formulaValue        =EDATE(A16, -4)    </span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; 24 0.015                           numberValue         0.015000           </span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; 25 1.50%                           numberValue         0.015000           </span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; 26 1.50%                           numberValue         0.015000           </span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; 27 1234567890                      numberValue         1234567890         </span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; 28 1.23E+09                        numberValue         1234567890         </span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; 29 $1.23                           numberValue         1.230000           </span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; 30 $1                              numberValue         1.230000           </span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; 31 $1.23                           numberValue         1.230000</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(formattedValue, <span class="kw">starts_with</span>(<span class="st">"effectiveValue"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; # A tibble: 31 x 3</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;    formattedValue                    effectiveValue_na… effectiveValue_va…</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;                             &lt;chr&gt;              &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;  1 x                                 stringValue        x                 </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;  2 3/10/2018 11:11:11                numberValue        43169.466100      </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;  3 3/11/2018                         numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;  4 3/11/2018                         numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  5 12:00:00 AM                       numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  6 3/11/2018 0:00:00                 numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  7 43170                             numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  8 43,170.00                         numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  9 Sunday, March 11, 2018 at 12:00:… numberValue        43170             </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; 10 3/11/2018 21:59:56                numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; 11 3/11/2018                         numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; 12 9:59:56 PM                        numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; 13 3/11/2018 21:59:56                numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; 14 43170.91662                       numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; 15 43,170.92                         numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; 16 Sunday, March 11, 2018 at 9:59:5… numberValue        43170.916618      </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; 17 11/11/2017                        numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; 18 11/11/2017                        numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; 19 12:00:00 AM                       numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; 20 11/11/2017 0:00:00                numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; 21 43050                             numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; 22 43,050.00                         numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; 23 Saturday, November 11, 2017 at 1… numberValue        43050             </span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt; 24 0.015                             numberValue        0.015000          </span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt; 25 1.50%                             numberValue        0.015000          </span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; 26 1.50%                             numberValue        0.015000          </span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; 27 1234567890                        numberValue        1234567890        </span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; 28 1.23E+09                          numberValue        1234567890        </span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; 29 $1.23                             numberValue        1.230000          </span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; 30 $1                                numberValue        1.230000          </span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt; 31 $1.23                             numberValue        1.230000</span></a></code></pre></div>
<p><code>effectiveFormat</code> holds an instance of <code>CellFormat</code> and we only care about the sub-component <code>NumberFormat</code>. If it exists, it has a <code>type</code> and possibly a <code>pattern</code>. Possible values for <code>type</code> of <code>NumberFormat</code>:</p>
<ul>
<li><code>TEXT</code></li>
<li><code>NUMBER</code></li>
<li><code>PERCENT</code></li>
<li><code>CURRENCY</code></li>
<li><code>DATE</code></li>
<li><code>TIME</code></li>
<li><code>DATE_TIME</code></li>
<li><code>SCIENTIFIC</code></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(formattedValue, <span class="kw">starts_with</span>(<span class="st">"effectiveFormat"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; # A tibble: 31 x 3</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;    formattedValue         effectiveFormat_n… effectiveFormat_nf_pattern   </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;                  &lt;chr&gt;              &lt;chr&gt;                        </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;  1 x                      &lt;NA&gt;               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;  2 3/10/2018 11:11:11     DATE_TIME          M/d/yyyy H:mm:ss             </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  3 3/11/2018              DATE               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;  4 3/11/2018              DATE               M/d/yyyy                     </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  5 12:00:00 AM            TIME               h:mm:ss am/pm                </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  6 3/11/2018 0:00:00      DATE_TIME          M/d/yyyy H:mm:ss             </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  7 43170                  TEXT               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  8 43,170.00              NUMBER             #,##0.00                     </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;  9 Sunday, March 11, 201… DATE_TIME          "dddd\", \"mmmm\" \"d\", \"y…</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; 10 3/11/2018 21:59:56     DATE_TIME          &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; 11 3/11/2018              DATE               M/d/yyyy                     </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; 12 9:59:56 PM             TIME               h:mm:ss am/pm                </span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; 13 3/11/2018 21:59:56     DATE_TIME          M/d/yyyy H:mm:ss             </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; 14 43170.91662            TEXT               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; 15 43,170.92              NUMBER             #,##0.00                     </span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; 16 Sunday, March 11, 201… DATE_TIME          "dddd\", \"mmmm\" \"d\", \"y…</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; 17 11/11/2017             DATE               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; 18 11/11/2017             DATE               M/d/yyyy                     </span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; 19 12:00:00 AM            TIME               h:mm:ss am/pm                </span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; 20 11/11/2017 0:00:00     DATE_TIME          M/d/yyyy H:mm:ss             </span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; 21 43050                  TEXT               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; 22 43,050.00              NUMBER             #,##0.00                     </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; 23 Saturday, November 11… DATE_TIME          "dddd\", \"mmmm\" \"d\", \"y…</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; 24 0.015                  &lt;NA&gt;               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; 25 1.50%                  PERCENT            0.00%                        </span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; 26 1.50%                  PERCENT            0.00%                        </span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; 27 1234567890             &lt;NA&gt;               &lt;NA&gt;                         </span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; 28 1.23E+09               SCIENTIFIC         0.00E+00                     </span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; 29 $1.23                  CURRENCY           "\"$\"#,##0.00"              </span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; 30 $1                     CURRENCY           "\"$\"#,##0"                 </span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; 31 $1.23                  CURRENCY           "\"$\"#,##0.00"</span></a></code></pre></div>
<p>An <code>NA</code> for the <code>type</code> of <code>NumberFormat</code> means there is no <code>NumberFormat</code>. If there is a <code>NumberFormat</code>, an <code>NA</code> for <code>pattern</code> of <code>NumberFormat</code> means a default for that type is selected based on the user’s locale. <em><a href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets#NumberFormat">The docs</a> say “user’s locale” and in other places are careful to say “spreadsheet’s locale”. Not sure what to make of this here.</em></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#peer-group">Peer group</a></li>
      <li><a href="#col-spec">Col spec</a></li>
      <li><a href="#parsing">Parsing</a></li>
      <li><a href="#guessing">Guessing</a></li>
      <li><a href="#google-sheet-cell-data-from-sheets-api-v4">Google Sheet cell data from Sheets API v4</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jennifer Bryan, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
