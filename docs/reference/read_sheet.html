<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read a Sheet into a data frame — read_sheet • googlesheets4</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<meta property="og:title" content="Read a Sheet into a data frame — read_sheet" />
<meta property="og:description" content="This is the main "read" function of the googlesheets4 package. The goal is
that read_sheet() is to a Google Sheet as readr::read_csv() is to a csv
file or read_excel() is to an Excel spreadsheet. It's still under
development, but is quite usable now. Note that googlesheets4 is not wired
up for auth yet (happening soon!), so at the moment the target Sheet must
be readable by anyone with a link (see examples for how to accomplish via
googledrive)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">googlesheets4</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/googlesheets4-conventions.html">googlesheets4 conventions</a>
    </li>
    <li>
      <a href="../articles/articles/googlesheets4-design-notes.html">googlesheets4 design notes</a>
    </li>
    <li>
      <a href="../articles/articles/sheets-api-v4.html">Google Sheets API v4</a>
    </li>
    <li>
      <a href="../articles/articles/sheets-auth-flow.html">Google Sheets API v4 Auth Flow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tidyverse/googlesheets4">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read a Sheet into a data frame</h1>
    <small>Source: <a href='https://github.com/tidyverse/googlesheets4/blob/master/R/read_sheet.R'><code>R/read_sheet.R</code></a></small>
    <div class="hidden name"><code>read_sheet.Rd</code></div>
    </div>

    <p>This is the main "read" function of the googlesheets4 package. The goal is
that <code>read_sheet()</code> is to a Google Sheet as <code><a href='http://www.rdocumentation.org/packages/readr/topics/read_delim'>readr::read_csv()</a></code> is to a csv
file or <code>read_excel()</code> is to an Excel spreadsheet. It's still under
development, but is quite usable now. <strong>Note that googlesheets4 is not wired
up for auth yet (happening soon!)</strong>, so at the moment the target Sheet must
be readable by anyone with a link (see examples for how to accomplish via
googledrive).</p>

    <pre class="usage"><span class='fu'>read_sheet</span>(<span class='no'>ss</span>, <span class='kw'>sheet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>col_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>na</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>trim_ws</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>skip</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>guess_max</span> <span class='kw'>=</span> <span class='fu'>min</span>(<span class='fl'>1000</span>, <span class='no'>n_max</span>))

<span class='fu'>sheets_read</span>(<span class='no'>ss</span>, <span class='kw'>sheet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>col_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>na</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>trim_ws</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>skip</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>n_max</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>guess_max</span> <span class='kw'>=</span> <span class='fu'>min</span>(<span class='fl'>1000</span>, <span class='no'>n_max</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ss</th>
      <td><p>Something that identifies a Google Sheet: its file ID, a URL from
which we can recover the ID, or a <code><a href='http://www.rdocumentation.org/packages/googledrive/topics/dribble'>dribble</a></code>, which
is how googledrive represents Drive files. Processed through
<code><a href='as_sheets_id.html'>as_sheets_id()</a></code>.</p></td>
    </tr>
    <tr>
      <th>sheet</th>
      <td><p>Sheet to read, as in "worksheet" or "tab". Either a string (the
name of a sheet), or an integer (the position of the sheet). Ignored if the
sheet is specified via <code>range</code>. If neither argument specifies the sheet,
defaults to the first visible sheet.</p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>A cell range to read from. If <code>NULL</code>, all non-empty cells are
read. Otherwise specify <code>range</code> as described in <a href='https://developers.google.com/sheets/api/guides/concepts#a1_notation'>Sheets A1 notation</a>
or using the helpers documented in <a href='cell-specification.html'>cell-specification</a>. Sheets uses
fairly standard spreadsheet range notation, although a bit different from
Excel. Examples of valid ranges: <code>"Sheet1!A1:B2"</code>, <code>"Sheet1!A:A"</code>,
<code>"Sheet1!1:2"</code>, <code>"Sheet1!A5:A"</code>, <code>"A1:B2"</code>, <code>"Sheet1"</code>. Interpreted
strictly, even if the range forces the inclusion of leading, trailing, or
embedded empty rows or columns. Takes precedence over <code>skip</code>, <code>n_max</code> and
<code>sheet</code>. Note <code>range</code> can be a named range, like <code>"sales_data"</code>, without
any cell reference.</p></td>
    </tr>
    <tr>
      <th>col_names</th>
      <td><p><code>TRUE</code> to use the first row as column names, <code>FALSE</code> to get
default names, or a character vector to provide column names directly. In
all cases, names are processed through <code><a href='http://www.rdocumentation.org/packages/tibble/topics/tidy_names'>tibble::tidy_names()</a></code>. If user
provides <code>col_types</code>, <code>col_names</code> can have one entry per column or one
entry per unskipped column.</p></td>
    </tr>
    <tr>
      <th>col_types</th>
      <td><p>Column types. Either <code>NULL</code> to guess all from the
spreadsheet or a string of readr-style shortcodes, with one character or
code per column. If exactly one <code>col_type</code> is specified, it is recycled.
See Details for more.</p></td>
    </tr>
    <tr>
      <th>na</th>
      <td><p>Character vector of strings to interpret as missing values. By
default, blank cells are treated as missing data.</p></td>
    </tr>
    <tr>
      <th>trim_ws</th>
      <td><p>Logical. Should leading and trailing whitespace be trimmed
from cell contents?</p></td>
    </tr>
    <tr>
      <th>skip</th>
      <td><p>Minimum number of rows to skip before reading anything, be it
column names or data. Leading empty rows are automatically skipped, so this
is a lower bound. Ignored if <code>range</code> is given.</p></td>
    </tr>
    <tr>
      <th>n_max</th>
      <td><p>Maximum number of data rows to read. Trailing empty rows are
automatically skipped, so this is an upper bound on the number of rows in
the returned tibble. Ignored if <code>range</code> is given.</p></td>
    </tr>
    <tr>
      <th>guess_max</th>
      <td><p>Maximum number of data rows to use for guessing column
types.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='http://www.rdocumentation.org/packages/tibble/topics/tibble-package'>tibble</a></p>
    <h2 class="hasAnchor" id="column-specification"><a class="anchor" href="#column-specification"></a>Column specification</h2>

    
    <p>Column types must be specified in a single string of readr-style short
codes, e.g. "cci?l" means "character, character, integer, guess, logical".
This is not where googlesheets4's col spec will end up, but it gets the
ball rolling in a way that is consistent with readr and doesn't reinvent
any wheels.</p>
<p>Shortcodes for column types:</p><ul>
<li><p><code>_</code> or <code>-</code>: Skip. Data in a skipped column is still requested from the
API (the high-level functions in this package are rectangle-oriented), but
is not parsed into the data frame output.</p></li>
<li><p><code>?</code>: Guess. A type is guessed for each cell and then a consensus type is
selected for each column. If no atomic type is suitable for all cells, a
list-column is created, in which each cell is converted to an R object of
"best" type". If no column types are specified, i.e. <code>col_types = NULL</code>,
all types are guessed.</p></li>
<li><p><code>l</code>: Logical.</p></li>
<li><p><code>i</code>: Integer. This type is never guessed from the data, because Sheets
have no formal cell type for integers.</p></li>
<li><p><code>d</code> or <code>n</code>: Numeric, in sense of "double".</p></li>
<li><p><code>D</code>: Date. This type is never guessed from the data, because date cells
are just serial datetimes that bear a "date" format.</p></li>
<li><p><code>t</code>: Time of day. This type is never guessed from the data, because time
cells are just serial datetimes that bear a "time" format. <em>Not implemented
yet; returns POSIXct.</em></p></li>
<li><p><code>T</code>: Datetime, specifically POSIXct.</p></li>
<li><p><code>c</code>: Character.</p></li>
<li><p><code>C</code>: Cell. This type is unique to googlesheets4. This returns raw cell
data, as an R list, which consists of everything sent by the Sheets API for
that cell. Has S3 type of <code>"CELL_SOMETHING"</code> and <code>"SHEETS_CELL"</code>. Mostly
useful internally, but exposed for those who want direct access to, e.g.,
formulas and formats.</p></li>
<li><p><code>L</code>: List, as in "list-column". Each cell is a length-1 atomic vector of
its discovered type.</p></li>
<li><p><em>Still to come</em>: duration (code will be <code>:</code>) and factor (code will be
<code>f</code>).</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sheets_example.html'>sheets_example</a></span>(<span class='st'>"deaths"</span>)
<span class='fu'>read_sheet</span>(<span class='no'>ss</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='st'>"A5:F15"</span>)</div><div class='output co'>#&gt; <span class='message'>Reading from 'deaths'</span></div><div class='output co'>#&gt; <span class='message'>Range "'arts'!A5:F15"</span></div><div class='output co'>#&gt; # A tibble: 10 x 6
#&gt;    Name     Profession   Age `Has kids` `Date of birth`     `Date of death`    
#&gt;    &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;              &lt;dttm&gt;             
#&gt;  1 David B… musician      69 TRUE       1947-01-08 00:00:00 2016-01-10 00:00:00
#&gt;  2 Carrie … actor         60 TRUE       1956-10-21 00:00:00 2016-12-27 00:00:00
#&gt;  3 Chuck B… musician      90 TRUE       1926-10-18 00:00:00 2017-03-18 00:00:00
#&gt;  4 Bill Pa… actor         61 TRUE       1955-05-17 00:00:00 2017-02-25 00:00:00
#&gt;  5 Prince   musician      57 TRUE       1958-06-07 00:00:00 2016-04-21 00:00:00
#&gt;  6 Alan Ri… actor         69 FALSE      1946-02-21 00:00:00 2016-01-14 00:00:00
#&gt;  7 Florenc… actor         82 TRUE       1934-02-14 00:00:00 2016-11-24 00:00:00
#&gt;  8 Harper … author        89 FALSE      1926-04-28 00:00:00 2016-02-19 00:00:00
#&gt;  9 Zsa Zsa… actor         99 TRUE       1917-02-06 00:00:00 2016-12-18 00:00:00
#&gt; 10 George … musician      53 FALSE      1963-06-25 00:00:00 2016-12-25 00:00:00</div><div class='input'><span class='fu'>read_sheet</span>(<span class='no'>ss</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='st'>"other!A5:F15"</span>, <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='st'>"ccilDD"</span>)</div><div class='output co'>#&gt; <span class='message'>Reading from 'deaths'</span></div><div class='output co'>#&gt; <span class='message'>Range "'other'!A5:F15"</span></div><div class='output co'>#&gt; # A tibble: 10 x 6
#&gt;    Name           Profession   Age `Has kids` `Date of birth` `Date of death`
#&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt; &lt;lgl&gt;      &lt;date&gt;          &lt;date&gt;         
#&gt;  1 Vera Rubin     scientist     88 TRUE       1928-07-23      2016-12-25     
#&gt;  2 Mohamed Ali    athlete       74 TRUE       1942-01-17      2016-06-03     
#&gt;  3 Morley Safer   journalist    84 TRUE       1931-11-08      2016-05-19     
#&gt;  4 Fidel Castro   politician    90 TRUE       1926-08-13      2016-11-25     
#&gt;  5 Antonin Scalia lawyer        79 TRUE       1936-03-11      2016-02-13     
#&gt;  6 Jo Cox         politician    41 TRUE       1974-06-22      2016-06-16     
#&gt;  7 Janet Reno     lawyer        78 FALSE      1938-07-21      2016-11-07     
#&gt;  8 Gwen Ifill     journalist    61 FALSE      1955-09-29      2016-11-14     
#&gt;  9 John Glenn     astronaut     95 TRUE       1921-07-28      2016-12-08     
#&gt; 10 Pat Summit     coach         64 TRUE       1952-06-14      2016-06-28     </div><div class='input'><span class='fu'>read_sheet</span>(<span class='fu'><a href='sheets_example.html'>sheets_example</a></span>(<span class='st'>"mini-gap"</span>))</div><div class='output co'>#&gt; <span class='message'>Reading from 'test-gs-mini-gapminder'</span></div><div class='output co'>#&gt; <span class='message'>Range "'Africa'"</span></div><div class='output co'>#&gt; # A tibble: 5 x 6
#&gt;   country      continent  year lifeExp     pop gdpPercap
#&gt;   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 Algeria      Africa     1952    43.1 9279525     2449.
#&gt; 2 Angola       Africa     1952    30.0 4232095     3521.
#&gt; 3 Benin        Africa     1952    38.2 1738315     1063.
#&gt; 4 Botswana     Africa     1952    47.6  442308      851.
#&gt; 5 Burkina Faso Africa     1952    32.0 4469979      543.</div><div class='input'><span class='fu'>read_sheet</span>(
  <span class='fu'><a href='sheets_example.html'>sheets_example</a></span>(<span class='st'>"mini-gap"</span>),
  <span class='kw'>sheet</span> <span class='kw'>=</span> <span class='st'>"Europe"</span>,
  <span class='kw'>range</span> <span class='kw'>=</span> <span class='st'>"A:D"</span>,
  <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='st'>"ccid"</span>
)</div><div class='output co'>#&gt; <span class='message'>Reading from 'test-gs-mini-gapminder'</span></div><div class='output co'>#&gt; <span class='message'>Range "'Europe'!A:D"</span></div><div class='output co'>#&gt; # A tibble: 5 x 4
#&gt;   country                continent  year lifeExp
#&gt;   &lt;chr&gt;                  &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;
#&gt; 1 Albania                Europe     1952    55.2
#&gt; 2 Austria                Europe     1952    66.8
#&gt; 3 Belgium                Europe     1952    68  
#&gt; 4 Bosnia and Herzegovina Europe     1952    53.8
#&gt; 5 Bulgaria               Europe     1952    59.6</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'>## converts a local Excel file to a Google Sheet</span>
<span class='co'>## and shares it such that "anyone with a link can view"</span>
<span class='fu'>library</span>(<span class='no'>googledrive</span>)
<span class='no'>local_xlsx</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>readxl</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/readxl/topics/readxl_example'>readxl_example</a></span>(<span class='st'>"deaths.xlsx"</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/googledrive/topics/drive_upload'>drive_upload</a></span>(<span class='no'>local_xlsx</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"spreadsheet"</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/googledrive/topics/drive_share'>drive_share</a></span>(<span class='no'>x</span>, <span class='kw'>role</span> <span class='kw'>=</span> <span class='st'>"reader"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"anyone"</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/googledrive/topics/drive_reveal'>drive_reveal</a></span>(<span class='no'>x</span>, <span class='st'>"permissions"</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#column-specification">Column specification</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jennifer Bryan, <a href='https://www.rstudio.com'><img src='http://tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

