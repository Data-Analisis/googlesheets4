<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Range specification • googlesheets4</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Range specification">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html">googlesheets4</a>
        <div class="info">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    </li>
    <li>
      <a href="../../articles/articles/range-specification.html">Range specification</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/googlesheets4">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Range specification</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/master/vignettes/articles/range-specification.Rmd"><code>vignettes/articles/range-specification.Rmd</code></a></small>
      <div class="hidden name"><code>range-specification.Rmd</code></div>

    </div>

    
    
<p>This is a very short article that serves mostly as internal documentation of how googlesheets4 prepares the range when requesting cell data from the Sheets API. The main purpose is to publish the table below that shows how all possible combinations of row and cell limits are translated into an A1-style range.</p>
<p>There are several ways to convey which cells you want to read in googlesheets4:</p>
<ul>
<li>
<code>range</code> is the primary argument for this and takes precendence over all others. <code>range</code> can be:
<ul>
<li>an <a href="https://developers.google.com/sheets/api/guides/concepts#a1_notation">A1-style spreadsheet range</a>, such as “A3:D7” or “arts!A5:F15”)</li>
<li>a named range, such as “arts”</li>
<li>a <code>cell_limits</code> object made with helpers from the cellranger package</li>
</ul>
The Sheets API defaults to “all non-empty cells” when no range is specified.</li>
<li>
<code>sheet</code> is an optional argument specifying sheet name or number. The Sheets API defaults to “first visible sheet” when <code>sheet</code> is unspecified. Note that a sheet name can also be conveyed via <code>range</code>, alone or along with a cell range.</li>
<li>
<code>skip</code> and <code>n_max</code> are optional arguments that can place lower/upper bounds on where we start reading or stop parsing.</li>
</ul>
<p>If a specific range is targetted, the Sheets API requires that this be specified as an A1-style range. Here is how all possible cell limits are converted to a valid range in the <code>GET</code> request for cell data. Depending on how the user expressed this range, googlesheets4 may do additional post-processing when parsing the cell data into the returned data frame.</p>
<table class="table">
<thead><tr class="header">
<th align="right">start_col</th>
<th align="right">start_row</th>
<th align="right">end_col</th>
<th align="right">end_row</th>
<th align="left">naive_range</th>
<th align="left">range</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">B2:D4</td>
<td align="left">B2:D4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">B2:D?</td>
<td align="left">B2:D</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">B2:?4</td>
<td align="left">B2:4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">B2:??</td>
<td align="left">B2:ZZZ</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">B?:D4</td>
<td align="left">B1:D4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">B?:D?</td>
<td align="left">B:D</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">B?:?4</td>
<td align="left">B1:4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">B?:??</td>
<td align="left">B:ZZZ</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">?2:D4</td>
<td align="left">A2:D4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">?2:D?</td>
<td align="left">A2:D</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">?2:?4</td>
<td align="left">2:4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">?2:??</td>
<td align="left">2:5000000</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">??:D4</td>
<td align="left">A1:D4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">??:D?</td>
<td align="left">A:D</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="left">??:?4</td>
<td align="left">1:4</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">??:??</td>
<td align="left">&lt;NULL&gt;</td>
</tr>
</tbody>
</table>
</div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="tidyverse">
  <p>googlesheets4 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
